package ${path}.${foldName};

import java.util.ArrayList;
import java.util.Date;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Set;
import java.util.Vector;
import javax.faces.model.SelectItem;
import org.apache.commons.lang.StringUtils;
import org.apache.myfaces.custom.fileupload.UploadedFile;
import com.gwall.biz.IGVouchBiz;
import com.gwall.core.GDatabase;
import com.gwall.core.GVouchBase;
import com.gwall.core.GenNo;
import com.gwall.util.MBUtil;
import com.gwall.util.SimpleDateUtils;

public class ${ClassName}MB extends GVouchBase {

    /* table ${ClassName} */
    public static final String MODULE = "${ClassNameUpper}";

    /* 创建BEAN */
    private ${ClassName}MBean mbean = new ${ClassName}MBean();

    private ${ClassName}DBean dbean = new ${ClassName}DBean();

    private ${ClassName}Dao ${foldName}Dao;
    /* 初始化权限 */
    public ${ClassName}MB() {
        this.regModule(this.MODULE);
        this.setSk_obj(new ${ClassName}MBean());
        ${foldName}Dao=new ${ClassName}Dao();
    }

    /* 单据操作属性 */
    private SelectItem[] flags = { new SelectItem("01", "制作中"),
            new SelectItem("11", "已审核"), new SelectItem("21", "部分预约"),
            new SelectItem("22", "全部预约"), new SelectItem("31", "到货中"),
            new SelectItem("32", "全部到货"), new SelectItem("41", "检验中"),
            new SelectItem("51", "入库中"), new SelectItem("99", "已完成"),
            new SelectItem("100", "已关闭") }; /* 单据状态 */


    /* 查询条件属性 */
    private String sk_start_pudt; // 采购时间(开始)

    private String sk_end_pudt; // 采购时间(结束)

    private String sk_baco; // 物料条码

    private String sk_inco; // 物料编码

    private String roids; // 记录需要答应的条码

    private String roid; // 行项目号

    private String qty; // 补打尾箱数量

    private String selbarsql; // 补打查询语句

    private String selbarroidsql; // 行号

    private boolean baraddshow; // 是否显示添加条码

    private String orid;

    private String updatedata; // 更新明细

	/**
     * Description 初始化查询条件
     * 
     * @param 无
     * @return 无
     * @author DEW <br>
     *         2011-08-06
     */
    public void initSK() {
        this.sk_start_pudt = null;
        this.sk_end_pudt = null;
        this.sk_baco = null;
        this.sk_inco = null;
        this.orid = null;
        this.initSearchKey(new ${ClassName}MBean());
    }

    /**
     * Description 获得单据信息
     * 
     * @param 无
     * @return 无
     * @author DEW <br>
     *         2011-08-29
     */
    public void getVouch() {
        boolean bool = "ok".equals(${foldName}Dao.getVouch(mbean));
        if (bool) {
            if (Integer.parseInt(this.mbean.getFlag()==null?"0":this.mbean.getFlag()) < 11) {
                this.commitStatus = true;
            } else {
                this.commitStatus = false;
            }
        }
    }

    /**
     * Description 页面查询
     * 
     * @param 无
     * @return 无
     * @author DEW <br>
     *         2011-08-30
     */
    public void search() {
        this.searchSQL = "";
        if (this.sk_start_date != null
                && this.sk_start_date.trim().length() > 0) {
            this.searchSQL += " and a.crdt >= to_date('"+this.sk_start_date.trim() + "','yyyy-mm-dd HH24:mi')";
        }
        if (this.sk_end_date != null && this.sk_end_date.trim().length() > 0) {
            this.searchSQL += " and a.crdt <= to_date('"+this.sk_end_date.trim() + "','yyyy-mm-dd HH24:mi')";
        }
        if (((${ClassName}MBean) this.sk_obj).getFlag() != null
                && !((${ClassName}MBean) this.sk_obj).getFlag().equals("00")) {
            this.searchSQL += " and a.flag = '"
                    + ((${ClassName}MBean) this.sk_obj).getFlag().trim() + "'";
        }
        if (!StringUtils.isBlank(orid)) {
            searchSQL += " and a.orid like '" + this.orid + "'";
        }
    }

    /**
     * Description 查询条码
     * 
     * @param 无
     * @return 无
     * @author DEW <br>
     *         2011-09-07
     */
    public void searchBar() {
        this.selbarsql = "";
        if (this.sk_baco != null && this.sk_baco.length() > 0) {
            this.selbarsql += " and a.baco like '" + this.sk_baco + "'";
        }
        if (this.sk_inco != null && this.sk_inco.length() > 0) {
            this.selbarsql += " and a.inco like '" + this.sk_inco + "'";
        }
    }

    /**
     * Description 添加单据
     * 
     * @param 无
     * @return 无
     * @author DEW <br>
     *         2011-09-01
     */
    public void addHead() {
        mbean.setCrus(this.gUserid);
        mbean.setCrna(this.gUsername);
        if(mbean.getCrdt() == null || mbean.getCrdt().length() < 10)
        {
        	mbean.setCrdt(SimpleDateUtils.toDate(new Date()));
        }
        msg = this.${foldName}Dao.addHead(mbean);
    }

    /**
     * Description 删除单据
     * 
     * @param 无
     * @return 无
     * @author DEW <br>
     *         2011-08-29
     */
    public void deleteHead() {
        this.msg = this.${foldName}Dao.deleteHead(this.sellist);

    }

    /**
     * Description 修改单据主表
     * 
     * @param 无
     * @return 无
     * @author DEW <br>
     *         2011-08-29
     */
    public void updateHead() {
        this.msg = this.${foldName}Dao.updateHead(mbean);
    }
    
    /**
     * Description 审核单据
     * 
     * @param 无
     * @return 无
     * @author DEW <br>
     *         2011-08-29
     */
    public void approveVouch() {
        this.msg = this.${foldName}Dao.approveVouch(this.mbean);
    }

    /**
     * Description 反审单据
     * 
     * @param 无
     * @return 无
     * @author DEW <br>
     *         2011-09-06
     */
    public void unApproveVouch() {
        this.msg = this.${foldName}Dao.unApproveVouch(this.mbean);
    }

    /**
     * Description 打印单据
     * 
     * @param 无
     * @return 无
     * @author DEW <br>
     *         2011-08-29
     */
    public void printVouch() {

    }

    /**
     * Description 添加明细
     * 
     * @param 无
     * @return 无
     * @author DEW <br>
     *         2011-08-29
     */
    public void addDetail() {
        this.msg = this.${foldName}Dao.addDetail(mbean, dbean);
    }

    /**
     * Description 删除明细
     * 
     * @param 无
     * @return 无
     * @author DEW <br>
     *         2011-08-29
     */
    public void deleteDetail() {
        this.msg = this.${foldName}Dao.deleteDetail(this.mbean, this.sellist);
    }

    /**
     * Description 修改明细
     * 
     * @param 无
     * @return 无
     * @author DEW <br>
     *         2011-08-29
     */
    public void updateDetail() {
        this.msg = this.${foldName}Dao.updateDetail(
                this.updatedata);
    }

    public void showBarCode() {

    }

    public void addDetails() {
        this.msg = this.${foldName}Dao.addDetail(mbean, this.sellist.replace("#@#",
                ","));
    }

    public String getSk_start_pudt() {
        return sk_start_pudt;
    }

    public void setSk_start_pudt(String sk_start_pudt) {
        this.sk_start_pudt = sk_start_pudt;
    }

    public String getSk_end_pudt() {
        return sk_end_pudt;
    }

    public void setSk_end_pudt(String sk_end_pudt) {
        this.sk_end_pudt = sk_end_pudt;
    }

    public SelectItem[] getFlags() {
        return flags;
    }

    public void setFlags(SelectItem[] flags) {
        this.flags = flags;
    }

    public ${ClassName}MBean getMbean() {
        return mbean;
    }

    public void setMbean(${ClassName}MBean mbean) {
        this.mbean = mbean;
    }

    public ${ClassName}DBean getDbean() {
        return dbean;
    }

    public void setDbean(${ClassName}DBean dbean) {
        this.dbean = dbean;
    }

    public String getRoids() {
        return roids;
    }

    public void setRoids(String roids) {
        this.roids = roids;
    }

    public String getRoid() {
        return roid;
    }

    public void setRoid(String roid) {
        this.roid = roid;
    }

    public String getQty() {
        return qty;
    }

    public void setQty(String qty) {
        this.qty = qty;
    }

    public String getSelbarsql() {
        return selbarsql;
    }

    public void setSelbarsql(String selbarsql) {
        this.selbarsql = selbarsql;
    }

    public boolean getBaraddshow() {
        if (this.roid.equals("")) {
            this.baraddshow = false;
        } else {
            this.baraddshow = true;
        }
        return baraddshow;
    }

    public void setBaraddshow(boolean baraddshow) {
        this.baraddshow = baraddshow;
    }

    public String getUpdatedata() {
        return updatedata;
    }

    public void setUpdatedata(String updatedata) {
        this.updatedata = updatedata;
    }

    public String getSk_baco() {
        return sk_baco;
    }

    public void setSk_baco(String sk_baco) {
        this.sk_baco = sk_baco;
    }

    public String getSk_inco() {
        return sk_inco;
    }

    public void setSk_inco(String sk_inco) {
        this.sk_inco = sk_inco;
    }

    public String getSelbarroidsql() {
        if (this.roid.equals("")) {
            this.selbarroidsql = " ";
        } else {
            this.selbarroidsql = " and roid = '" + this.roid + "'";
        }
        return selbarroidsql;
    }

    public void setSelbarroidsql(String selbarroidsql) {
        this.selbarroidsql = selbarroidsql;
    }

    public static String getMODULE() {
        return MODULE;
    }

    public String getOrid() {
        return orid;
    }

    public void setOrid(String orid) {
        this.orid = orid;
    }

    @Override
    public IGVouchBiz getVouchBiz() {
        return null;
    }

	@Override
	public void printCode() {
		// TODO Auto-generated method stub
		
	}
}
